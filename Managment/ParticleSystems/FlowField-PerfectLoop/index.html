<!DOCTYPE html>
<html lang="">

<head>
  <meta charset="utf-8">
  <link rel="stylesheet" href="../../../css/style.css">
  <link href="https://fonts.googleapis.com/css?family=Alata|Anton|Assistant|BenchNine|Orbitron|Pathway+Gothic+One|Teko&display=swap" rel="stylesheet">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Flow Field Perfect Noise Loop</title>
  <style>
    body {
      padding: 0;
      margin: 0;
      background-color: black;
    }
  </style>
  <script src="libraries/p5.js"></script>
  <script src="libraries/p5.dom.js"></script>
  <script src="sketch.js"></script>
</head>

<body>
  <div id="topnav">
    <h2 id="PageTag">Flow Field Perfect Noise Loop</h2>
  </div>

  <a href="javascript:void(0);">

    <div id="nav-icon1" onclick="MyToggle()">
      <span></span>
      <span></span>
      <span></span>
    </div>
  </a>

  <div class="mySideMenu" id="mySide">
    <nav id="MyNav" class="MyNav">
      <h2 style="color:#BF9673">Sidebar</h2>
      <ul>
        <li><a href="../../../index.html">Home</a></li>
        <li><a href="../../../task3.html">Interaction Design & Unity</a></li>
        <li><a href="../../../p5.html">JavaScript</a></li>
        <li><a href="../../../Sound.html">Sound Visualization</a></li>
        <li><a href="../../../Managment/RainFall-Steer-v18-ForSub/index.html">Information Visualization</a></li>
        <li><a href="../../../Logo.html">Logo Redesign</a></li>
      </ul>
    </nav>
  </div>

  <div id="ToolBox">
    <h3>Tools</h3>
    <h5>Field Shifts Speed</h5>
    <h5>Noise Value</h5>
    <h5>Stroke Thickness</h5>
    <h5>Canvas Opacity</h5>
    <br>

    <input type="range" min="0.000001" max="0.001" value="0.000001" step="0.00001" class="slider" id="zInc">
    <input type="range" min="0.0001" max="0.1" value="0.02" step="0.0001" class="slider" id="xyInc">
    <input type="range" min="10" max="255" value="10" step="1" class="slider" id="ParticlesD">
    <input type="range" min="0.1" max="255" value="0.1" step="1" class="slider" id="CanD">
    <br>

    <div onclick="shapeShoft(this.id)" id="eleOne">Save Screen</div>
    <div onclick="shapeShoft(this.id)" id="eleTwo" style="display: none">Dance Loop Mode</div>

    <input id="resive" style="display:none">
  </div>
  </div>
  <a href="../../../p5.html">
    <div id="BackB" onmouseover="hoverOnClassToggle(this.id)" onmouseout="hoverOffClassToggle(this.id)">
      <span></span>
      <span></span>
    </div>
  </a>

  <figure id="CodeContainer">
    <pre>
    <code>
      var cols, rows;
      var scl = 10;
      var p;
      var particles = [];
      var a = 0;
      var inc = 0.01;
      var zinc = 0.0001;
      var zoff = 0;
      var count = 0;

      function setup() {
        createCanvas(windowWidth, windowHeight);
        cols = floor(width / scl);
        rows = floor(height / scl);
        p = new Array(cols * rows);

        for (var i = 0; i < 2000; i++) {
          particles[i] = new Particle();
        }
        background(0);
      }

      function draw() {
        var canDen = float(CanD.value);
        background(0, canDen);
        zinc = float(zInc.value);
        inc = float(xyInc.value);
        var mode = resive.value;
        console.log(mode);
        if (mode == "eleOne" && count < 1) {
          save('FlowField-AminPort.jpg');
          console.log("Image saved");
          count++;
        }

        var yoff = 0;
        for (var x = 0; x < cols; x++) {
          var xoff = 0;
          for (var y = 0; y < rows; y++) {
            var index = x + y * cols;
            a += radians(10);
            var angle = map(noise(xoff, yoff, zoff), 0, 1, 0, TWO_PI);
            var v = p5.Vector.fromAngle(angle);
            v.setMag(1);
            p[index] = v;
            xoff += inc;
            // push();
            // translate(x * scl, y * scl);
            // rotate(v.heading());
            // stroke(255);
            // line(0, 0, scl, 0);
            // pop();
          }
          yoff += inc;
          zoff += zinc;
        }

        for (var i = 0; i < particles.length; i++) {
          particles[i].follow(p);
          particles[i].update();
          particles[i].edges();
          // particles[i].edges2();
          // particles[i].edges3();
          particles[i].calColor();
          particles[i].show();
        }
      }

      function Particle() {
        var r = 0;
        var g = 0;
        var b = 0;

        this.pos = createVector(random(width), random(height));
        this.vel = createVector(0, 0);
        this.acc = createVector(0, 0);

        this.prevPos = this.pos.copy();

        this.update = function() {
          this.vel.add(this.acc);
          this.pos.add(this.vel);
          this.vel.limit(4);
          this.acc.mult(0);
        }
        this.applyForce = function(force) {
          this.acc.add(force);
        }

        this.calColor = function() {
          r = map(
            this.pos.x, 0, width, 0, 255
          );
          g = map(
            this.pos.y, 0, height, 0, 255
          );
          b = map(
            this.vel.mag(), 0, 4, 0, 255
          );
        }
        this.show = function() {

          beginShape();
          var al = float(ParticlesD.value);

          stroke(255, 255, 255, al);
          strokeWeight(0.3);

          curveVertex(this.pos.x, this.pos.y);
          curveVertex(this.prevPos.x, this.prevPos.y);
          endShape(CLOSE);
          this.updatePrev();
        }

        this.updatePrev = function() {
          this.prevPos.x = this.pos.x;
          this.prevPos.y = this.pos.y;
        }

        this.edges = function() {
          if (this.pos.x > width) {
            this.pos.x = random(width);
            this.pos.y = random(height);
            this.updatePrev();
          }
          if (this.pos.x < 0) {
            this.pos.x = random(width);
            this.pos.y = random(height);
            this.updatePrev();
          }
          if (this.pos.y > height) {
            this.pos.x = random(width);
            this.pos.y = random(height);
            this.updatePrev();
          }
          if (this.pos.y < 0) {
            this.pos.x = random(width);
            this.pos.y = random(height);
            this.updatePrev();
          }
        }
        this.edges2 = function() {
          if (this.pos.x > width) {
            this.pos.x = random(width);
            this.updatePrev();
          }
          if (this.pos.x < 0) {
            this.pos.x = random(width);
            this.updatePrev();
          }
          if (this.pos.y > height) {
            this.pos.y = random(height);
            this.updatePrev();
          }
          if (this.pos.y < 0) {
            this.pos.y = random(height);
            this.updatePrev();
          }
        }
        this.edges3 = function() {
          if (this.pos.x > width) {
            this.pos.x = 0;
            this.updatePrev();
          }
          if (this.pos.x < 0) {
            this.pos.x = width;
            this.updatePrev();
          }
          if (this.pos.y > height) {
            this.pos.y = 0;
            this.updatePrev();
          }
          if (this.pos.y < 0) {
            this.pos.y = height;
            this.updatePrev();
          }
        }
        this.follow = function(vectors) {
          var x = floor(this.pos.x / scl);
          var y = floor(this.pos.y / scl);
          var index = x + y * cols;
          var force = vectors[index];
          this.applyForce(force);
        }

      }
    </code>
  </pre>
  </figure>

  <div id="codeButton" onclick="showInfo(CodeContainer)"></div>

  <script src="../../../js/Scripts.js"></script>
</body>

</html>